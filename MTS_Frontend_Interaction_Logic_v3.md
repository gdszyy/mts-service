# MTS 前端交互逻辑设计 v3 (细节完善版)

**版本**: 3.0  
**日期**: 2025-12-01  
**作者**: Manus AI

---

## 1. 概述

本文档在采纳了用户的专业反馈后，对 MTS 前端交互逻辑进行了第三次迭代。v3 版本在 v2 的“单关/串关”双模式基础上，进一步完善了**模式切换时的金额处理**、**快捷金额选项**、**个性化设置页面**以及**全面的异常情况处理**等关键细节，旨在提供一套真正达到业界领先水平的、精细化且用户友好的投注体验。

---

## 2. 核心交互逻辑 (基于 v2)

核心交互依然遵循 v2 版本的设计，即以用户在投注单顶部手动切换 **“单关” (Single)** 和 **“串关” (Multi)** 两种模式为基础。

-   **单关模式**: 允许用户为多个选项独立输入金额，实现一次性批量提交多个单注。
-   **串关模式**: 将所有选项聚合，提供“串关”、“系统”和“Banker”三种复杂的组合投注方式。

![投注单核心交互流程 v2](flowcharts_v2/bet_slip_core_flow_v2.mmd)

**图 1：投注单核心交互流程图 (v2)**

---

## 3. 细节深化与增强 (v3 新增)

### 3.1. 模式切换时的金额处理

为了防止用户在切换模式时因金额逻辑不兼容而产生误解或损失，我们制定了明确的金额处理规则。

-   **核心原则**：**清空并确认**。在不同模式（或串关模式内的不同子模式）之间切换时，由于金额的计算基础（独立金额 vs. 总金额 vs. 单位金额）完全不同，系统应清空已输入的金额，并弹窗提示用户，以避免逻辑混乱。

![模式切换金额处理流程](flowcharts_v3/mode_switch_amount_handling.mmd)

**图 2：模式切换金额处理流程图**

| 切换路径 | 处理方式 | 用户提示 |
| :--- | :--- | :--- |
| 单关 → 串关 | 清空所有独立金额 | “切换到串关模式将清空所有单关投注金额，是否继续？” |
| 串关 → 单关 | 清空总金额或单位金额 | “切换到单关模式将清空所有串关投注金额，是否继续？” |
| 串关（子模式切换） | 清空金额 | “切换投注方式将清空已输入的金额，是否继续？” |

### 3.2. 便捷功能设计

#### 3.2.1. 快捷金额选项

为了提升投注效率，金额输入框旁边应提供一组可配置的快捷金额按钮。

-   **预设值**: 例如 `+5`, `+10`, `+20`, `+50`, `+100`, `Max`。
-   **交互**: 点击 `+X` 按钮可累加金额；点击 `Max` 按钮可一键填充最大可用额度。

![快捷金额交互流程](flowcharts_v3/quick_amount_interaction.mmd)

**图 3：快捷金额交互流程图**

#### 3.2.2. 设置页面

一个独立的“设置页面”将赋予用户根据个人偏好深度定制投注体验的能力。

![设置页面结构](flowcharts_v3/settings_page_structure.mmd)

**图 4：设置页面结构图**

该页面应至少包含以下几个核心设置分区：

| 分区 | 设置项 | 选项 | 备注 |
| :--- | :--- | :--- | :--- |
| **赔率设置** | 赔率展示方式 | 小数、分数、美式 | 默认小数，选择后全局实时更新 |
| | 接受赔率变化 | 不接受、接受任何、只接受更高 | 决定赔率变化时是否需要用户手动确认 |
| **投注设置** | 快捷金额自定义 | 用户可增删改快捷金额按钮的值 | 提升投注效率 |
| | 默认投注模式 | 单关、串关 | 用户登录后的默认投注单模式 |
| **通知设置** | 异步通知偏好 | 弹窗、消息中心、无 | 管理投注结果的通知方式 |

### 3.3. 异常情况处理

清晰、及时的异常处理是建立用户信任和提供流畅体验的基石。我们必须对各种可能出现的异常情况进行周全的设计。

![异常情况处理流程](flowcharts_v3/exception_handling.mmd)

**图 5：异常情况处理流程图**

| 异常情况 | 前端展示与交互 |
| :--- | :--- |
| **赔率变化** | - 高亮变化的赔率（如红色闪烁）。<br>- 根据用户设置（接受/不接受/只接受更高）决定是否需要弹窗确认。 |
| **选项失效** | - 将失效选项置灰并显示原因（如“盘口已关闭”）。<br>- 自动从投注单中移除，并弹窗通知用户。 |
| **余额不足** | - 在金额输入框下方显示红色错误信息“余额不足”。<br>- “投注”按钮禁用或变为“充值”按钮。 |
| **API 错误** | - 在投注单顶部显示具体的错误信息。<br>- 根据错误类型（临时性或业务逻辑性）建议用户重试或修正。 |
| **网络连接问题** | - 在页面顶部显示全局警告条“网络连接不稳定”。<br>- 禁用所有投注相关按钮，直到网络恢复。 |

---

## 4. 结论

v3 版本的设计方案在 v2 的基础上，通过对关键细节的深化和完善，构建了一套真正专业、健壮且人性化的前端交互逻辑。它不仅为用户提供了强大的灵活性和个性化选项，也为各种异常情况设计了清晰的反馈和引导机制。我们强烈建议开发团队以此 v3 文档作为最终的开发蓝图，以打造出一款业界领先的 MTS 投注产品。
